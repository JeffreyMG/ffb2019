USE Fantasy_Football

SELECT * 
INTO Ten_yr_tbl_bkup
FROM dbo.Ten_yr_tbl
;

--Add field for points in a season
ALTER TABLE dbo.10yr_tbl ADD Points As ((Pass_Yds * .04) + (Pass_TD * 4) + (Pass_Int * -1) + (Rush_Yds * .1) + (Rush_TD * 6) + (Rcv_Yds * .1) + (Rcv_TD * 6))
;

--check if any high ranking players have Null at FantPos (position)
SELECT *
FROM dbo.Ten_yr_tbl
WHERE FantPos IS Null
ORDER BY Points DESC
;

--player Chad Johnson has Null FantPos, change FantPos to 'WR'
UPDATE dbo.Ten_yr_tbl
SET FantPos = 'WR'
WHERE FantPos IS Null
AND Name = 'Chad Johnson'
;

--SELECT all records with any Null fields
SELECT *
FROM dbo.Ten_yr_tbl
WHERE Year Is Null
OR Name Is Null
Or Team Is Null
Or FantPos Is Null
Or Age Is Null
Or Games_Played Is Null
Or Games_Started Is Null
Or Pass_Cmp Is Null
Or Pass_Att Is Null
Or Pass_Yds Is Null
Or Pass_Td Is Null
Or Rush_Att Is Null
Or Rush_TD Is Null
Or Rush_Yds Is Null
Or Rcv_Tgt Is Null
Or Rcv_Rec Is Null
Or Rcv_Yds Is Null
Or Rcv_TD Is Null
Or Fantasy_Pos_Rank Is Null
Or Points Is Null
ORDER BY Points DESC 
;

--find records where there are duplicate Year-Name combinations 
SELECT a.Year, a.Name, count(a.Name) AS Count_Nm
FROM dbo.Ten_yr_tbl As a
GROUP BY Year, Name
ORDER BY Count_Nm DESC;

--there are multiple Year-Name duplicates, see if Year-Name-Team-FantPos is unique
SELECT a.Year, a.Name, a.Team, a.FantPos, count(a.Name) AS Count_Nm
FROM dbo.Ten_yr_tbl As a
GROUP BY Year, Name, FantPos, Team
ORDER BY Count_Nm DESC;
--Year-Name-Team-FantPos is unique


